function initializeEPMLiveNotifications(){$.getScript("/_layouts/epmlive/javascripts/libraries/jquery.timeago.js",function(){$.getScript("/_layouts/epmlive/javascripts/libraries/jquery.endless-scroll.js",function(){$.getScript("/_layouts/epmlive/javascripts/libraries/slimScroll.js",function(){(function(){var r=window.jQuery,t=window.epmLive,e,i=!0,u,n;try{e=window.console}catch(o){window.console||(e={log:function(){}})}try{u=!1;n=window.epmLiveNotifications;n.messageTypeImageCollection={0:"system",1:"system",3:"comment",4:"assigned-to",5:"pending-project-update",12:"resources",13:"resources"};n.queryInterval=3e4;n.init();ko.applyBindings(n,document.getElementById("EPMLiveNotificationsWrap"));ko.applyBindings(n,document.getElementById("EPMLiveNotificationCounter"));ko.applyBindings(n,document.getElementById("EPMLiveNotificationCount"));function s(f,e){var c,p,l,h,o,a,v,w,y,b,s,k,g,d,nt;if(f){if(c=f.length?f:[f],p=n.notificationQueryLimit(),l=c.length,!i&&e==="NEW"&&l>p){for(l=p,h=[],o=0;o<n.notifications().length;o++)h.push(n.notifications()[o]);for(o=0;o<h.length;o++)n.notifications.remove(h[o]);for(h=[],o=0;o<n.invisibleNotifications().length;o++)h.push(n.invisibleNotifications()[o]);for(o=0;o<h.length;o++)n.invisibleNotifications.remove(h[o])}for(a=0;a<l;a++){v=c[a];w={};for(y in v)if(v.hasOwnProperty(y))try{b=y.replace(/@/,"").toLowerCase();s=v[y];b!=="createdatdatestring"&&(t.isGuid(s)||(s["#cdata"]?s=s["#cdata"]:s==="true"?s=!0:s==="false"?s=!1:s.indexOf(" ")===-1?(k=parseInt(s),isNaN(k)||(s=k)):(g=Date.parse(s),isNaN(g)||(s=new Date(s)))));w[b]=ko.observable(s)}catch(tt){}n.registerNotification(w)}i||e!=="NEW"||r("#EPMLiveNotificationCount").text()!==c.length+""&&(n.totalNewNotifications(c.length),d="#D0D0D0",r("#EPMLiveNotificationsWrap").is(":visible")||(d=n.newSystemNotifications().length>0?"#89CE00":n.newGeneralNotifications().length>0?"#26C6F4":"#547194"),r("#EPMLiveNotificationCounter").css("background",d));n.firstTimeLoad=!1;u||(nt=n.notificationDisplayLimit,n.notificationDisplayLimit=5,n.retrieveMoreNotifications("GENERAL","OLD"),n.notificationDisplayLimit=nt,u=!0)}}function f(u,e,o,h){u!=="ALL"&&u!=="NEW"&&u!=="OLD"&&(u="ALL");e||(e=0);o||(o=0);h||(h=0);var c='<Notifications Status="'+u+'" Limit="'+e+'" FirstPage="'+o+'" LastPage="'+h+'" FirstLoad="'+i+'"/>';r.ajax({type:"POST",url:t.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: 'GetNotifications', Dataxml: '"+c+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(r){if(r.d){var f=t.parseJson(r.d);t.responseIsSuccess(f.Result)?f.Result.Notifications&&(s(f.Result.Notifications.Notification,u),i&&(i=!1,n.totalNewNotifications(f.Result.Notifications["@TotalNew"]))):t.logFailure(f.Result)}else t.log("response.d: "+r.d)},error:function(n){t.log(n)}});(u==="NEW"||u==="ALL")&&setTimeout(function(){f("NEW")},n.queryInterval)}n.retrieveMoreNotifications=function(t,i){n.getMoreNotifications(t,i)||(f(i,n.notificationQueryLimit(),n.notificationFirstPage(),n.notificationLastPage()),n.notificationFirstPage(n.notificationLastPage()))};f("ALL")}catch(o){t.log(o)}})()},!window.isIE8)},!window.isIE8)},!window.isIE8)}ExecuteOrDelayUntilScriptLoaded(initializeEPMLiveNotifications,"EPMLive.js");
//# sourceMappingURL=Notifications.min.js.map