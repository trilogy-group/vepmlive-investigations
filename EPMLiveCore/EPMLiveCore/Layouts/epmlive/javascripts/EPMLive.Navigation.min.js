(function(){function t(){ExecuteOrDelayUntilScriptLoaded(n,"EPMLiveNavigation")}var n=function(){$(function(){var n=window.jQuery,t=function(){var t=function(t,i,r,u){var f=window.epmLive;n.ajax({type:"POST",url:f.currentWebUrl+"/_vti_bin/WorkEngine.asmx/Execute",data:"{ Function: '"+t+"', Dataxml: '"+i+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.d){var i=f.parseJson(n.d),t=i.Result;f.responseIsSuccess(t)?r(t):u(n)}else u(n)},error:function(n){u(n)}})};return{execute:t}}(),i=function(){var l=300,a="epm-nav-node",v="epm-nav-node-hover",o="epm-nav-node-opened",u="epm-nav-node-selected",y="epmnav-selected-tlnode",p="epmnav-selected-link",s="epmnav-expand-state",h="epmnav-pin-state",f={expires:365,path:"/"},i=n("#epm-nav-sub"),r=[],k=function(t){var a=t,e=n(t),s=n("#epm-nav-sub-"+e.data("id")),c=a.id,v=function(){return e.parent().hasClass(u)},d=function(){return e.parent().hasClass(o)},p=function(n){n?e.parent().addClass(u):e.parent().removeClass(u)},w=function(){s.hide();e.parent().removeClass(o)},b=function(){i.is(":visible")&&i.hide("slide",{direction:"left"},l);w()},g=function(){s.show();e.parent().addClass(o)},k=function(){g();i.is(":visible")||i.show("slide",{direction:"left"},l)};return e.click(function(){var i,t;if(v())d()&&n.cookie(h)==="unpinned"?b():k();else{for(i in r)t=r[i],t.id!==c&&t.selected()&&(t.select(!1),t.close());p(!0);k();n.cookie(y,c,f)}}),{id:c,selected:v,select:p,close:w,closeNav:b,el:a,$el:e,$menu:s}},w=function(){for(var t,n=0;n<r.length;n++)if(t=r[n],t.selected()){t.closeNav();break}},c=function(t){var e=["s4-ribbonrow","s4-workspace"],o,r,u;for(o in e)r=n("#"+e[o]),r.removeClass("epm-nav-pinned"),r.removeClass("epm-nav-unpinned"),r.addClass("epm-nav-"+t);u=n("#epm-nav-pin");u.removeClass("epm-nav-pin-pinned");u.removeClass("epm-nav-pin-unpinned");u.addClass("epm-nav-pin-"+t);t==="unpinned"&&w();i.data("pinstate",t);n.cookie(h,t,f)},d=function(){i.data("pinstate")==="pinned"?c("unpinned"):c("pinned")},g=function(t,i){var r=n.parseJSON(n.cookie(s))||{};r[t]=i;n.cookie(s,JSON.stringify(r),f)},nt=function(){var o=window.TreeView_HoverNode,s=window.TreeView_UnhoverNode,h=window.TreeView_ToggleNode,r,u,t;window.TreeView_HoverNode=function(t,i){var r=n(i);r.hasClass(a)?r.parent().parent().parent().addClass(v):o(t,i)};window.TreeView_UnhoverNode=function(t){var i=n(t);i.hasClass(a)?n(t).parent().parent().parent().removeClass(v):s(t)};window.TreeView_ToggleNode=function(t,i,r,u,f){for(var p=[],l=null,w=n(r).parents("div"),a,b,v,o,y,c,s=0;s<w.length;s++)if(a=w[s],b=n(a),b.hasClass("epm-nav-sub")){for(l=a.id,v=e(l),o=0;o<v.length;o++)y=v[o],c=n(y).is(":visible"),y.id.replace("Nodes","")===r.id&&(c=!c),p[o]=c;break}g(l,p);h(t,i,r,u,f)};r=["suiteBar","s4-ribbonrow","s4-workspace"];for(u in r)n("#"+r[u]).click(function(){i.data("pinstate")==="unpinned"&&w()});t=n("#epm-nav-pin");t.click(function(){d()});i.hover(function(){t.show()},function(){t.hide()});n("a.epm-nav-node").click(function(){var r=-1,u=n(this),o=u.parents("div")[0],s=n(o).siblings("div"),i,t,h;if(s)for(i=e(n(s[0]).parent().parent().attr("id")),t=0;t<i.length;t++)h=i[t],h.id===o.id&&(r=t);n.cookie(p,JSON.stringify({index:r,uri:u.attr("href")}),f)})},b=function(){return(n.cookie(y)||"epm-nav-top-ql").replace("epm-nav-top-","epm-nav-sub-")},e=function(t){return n("#"+t).find(".epm-nav-sub-menu").find("div[id^=E]")},tt=function(){var o=n.parseJSON(n.cookie(s)),i,r,u,t,f,h;if(o&&(i=b(),r=o[i],r&&i==="epm-nav-sub-ql"))for(u=e("epm-nav-sub-ql"),t=0;t<u.length;t++)r[t]&&(f=u[t].id,h=f.replace("Nodes",""),TreeView_ToggleNode(window.EPMLiveNav_Data,0,document.getElementById(h)," ",document.getElementById(f)))},it=function(){var f=n.parseJSON(n.cookie(p)),i,r,o,s,t;if(f&&(i=f.index,r=f.uri,window.location.href.indexOf(r)!==-1))if(o=n("#"+b()),i&&i!==-1){for(s=e(o.parent().attr("id")),t=0;t<s.length;t++)if(t===i){n(s[t]).find('a[href="'+r+'"]:first').parents("table").addClass(u);break}}else o.find('a[href="'+r+'"]:first').parents("table").addClass(u)},rt=function(){for(var i=[],u,f,n=0;n<r.length;n++)u=r[n],u.selected()||(f=u.$el.data("linkprovider"),f&&i.push(f));i.length>0&&t.execute("GetNavigationLinks",i.join(),function(n){var i,t,r,u,f;for(i in n.Nodes){t=n.Nodes[i].NavLink;for(r in t)u=t[r],f=0}},function(n){console.log(n)})},ut=function(){var t=n.cookie(h);n("#epm-nav-top").find("[data-role='top-nav-node']").each(function(){r.push(new k(this))});c(t||"pinned");tt();it();nt();ExecuteOrDelayUntilScriptLoaded(rt,"EPMLive.js")};return{init:ut}}();i.init()})};ExecuteOrDelayUntilScriptLoaded(t,"jquery.min.js")})();
//@ sourceMappingURL=EPMLive.Navigation.min.js.map