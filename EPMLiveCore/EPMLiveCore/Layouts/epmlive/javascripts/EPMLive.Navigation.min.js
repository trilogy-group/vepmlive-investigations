(function(){"use strict";function n(){$(function(){var n=window.jQuery,i=function(){var t=function(){return window.epmLiveNavigation.currentWebUrl},i=function(xml){return eval("("+window.xml2json(n.parseXML(xml),"")+")")},r=function(n){return n["@Status"]==0};return{currentWebUrl:t,parseJson:i,responseIsSuccess:r}}(),e=function(){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=function(t){var i="",o,s,h="",c,f,r,e="",u=0;/[^A-Za-z0-9\+\/\=]/g.exec(t)&&console.log('There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, "+", "/",and "="\nExpect errors in decoding.');t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do c=n.indexOf(t.charAt(u++)),f=n.indexOf(t.charAt(u++)),r=n.indexOf(t.charAt(u++)),e=n.indexOf(t.charAt(u++)),o=c<<2|f>>4,s=(f&15)<<4|r>>2,h=(r&3)<<6|e,i=i+String.fromCharCode(o),r!=64&&(i=i+String.fromCharCode(s)),e!=64&&(i=i+String.fromCharCode(h)),o=s=h="",c=f=r=e="";while(u<t.length);return unescape(i)};return{decode:t}}(),t=function(){var t=function(r,u,f,e){var o=i.currentWebUrl();o?n.ajax({type:"POST",url:(o+"/_vti_bin/WorkEngine.asmx/Execute").replace(/\/\//g,"/"),data:"{ Function: '"+r+"', Dataxml: '"+u+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.d){var r=i.parseJson(n.d),t=r.Result;i.responseIsSuccess(t)?f(t):e(n)}else e(n)},error:function(n){e(n)}}):window.setTimeout(function(){t(r,u,f,e)},1)};return{execute:t}}(),r=n.cookie,u;n.cookie=function(n,t,i){if(n=n+"-u-"+window.epmLiveNavigation.currentUserId,r){if(!t)return r(n);r(n,t,i)}};u=function(){function rt(){for(var t,n=0;n<u.length;n++)if(t=u[n],t.selected()){t.closeNav();break}}function p(t,i){var e=["s4-ribbonrow","s4-workspace"],o,u,f;for(o in e)u=n("#"+e[o]),u.removeClass("epm-nav-pinned"),u.removeClass("epm-nav-unpinned"),u.addClass("epm-nav-"+t);f=n("#epm-nav-pin");f.removeClass("epm-nav-pin-pinned");f.removeClass("epm-nav-pin-unpinned");f.addClass("epm-nav-pin-"+t);t==="unpinned"&&rt();r.data("pinstate",t);i&&n.cookie(y,t,c)}function st(){return(n.cookie(it)||"epm-nav-top-ql").replace("epm-nav-top-","epm-nav-sub-")}function l(t){return n("#"+t).find(".epm-nav-sub-menu").find("div[id^=E]")}function ht(){var t=n.parseJSON(n.cookie(v)),s,h,u,e,o,c,a,i;if(t)if(t.id)s=n(r.find("#"+t.id).get(0)),s.length>0&&(h=s.parent(),u=h.parent().get(0).id,u!=="epm-nav-sub-favorites-static-links"&&u!=="epm-nav-sub-recent-static-links"&&u!=="epm-nav-sub-new-static-links"&&h.addClass(f));else if(e=t.index,o=t.uri,window.location.href.indexOf(o)!==-1)if(c=n("#"+st()),e&&e!==-1){for(a=l(c.parent().attr("id")),i=0;i<a.length;i++)if(i===e){n(a[i]).find('a[href="'+o+'"]:first').parents("table").addClass(f);break}}else c.find('a[href="'+o+'"]:first').parents("table").addClass(f)}function ct(t){var i={};t.find(".epm-nav-cat").each(function(){var t=n(this);i[t.text()]=n(t.find("span")[0]).hasClass(o)});ut(t.get(0).id,i)}function ut(t,i){var r=n.parseJSON(n.cookie(h))||{};r[t]=i;n.cookie(h,JSON.stringify(r),c)}function w(t){var p=n.parseJSON(n.cookie(h)),i,r,s,f,c,e,a,v,y;if(p){if(i="epm-nav-sub-ql",t)for(r=0;r<u.length;r++)if(s=u[r],s.provider===t){i=s.id.replace("epm-nav-top-","epm-nav-sub-");break}if(f=p[i],f)if(i==="epm-nav-sub-ql")for(c=l("epm-nav-sub-ql"),e=0;e<c.length;e++)a=c[e],v=a.id.replace("Nodes",""),f[n("#"+v.replace("EPMLiveNavn","EPMLiveNavt")).text()]||TreeView_ToggleNode(window.EPMLiveNav_Data,0,document.getElementById(v)," ",document.getElementById(a.id));else y=n("#"+i).find(".epm-nav-cat"),i==="epm-nav-sub-settings"&&y.each(function(){b(n(this))}),y.each(function(){var t=n(this),r=t.text(),i=f[r];n(t.find("span")[0]).hasClass(o)?i||b(t):i&&ft(t)})}}function ft(t){var u=t.get(0).id,i=n(t.find("span")[0]),r=n("#"+u+"-links");i.removeClass(s);i.addClass(o);r.removeClass(s);r.addClass(o)}function b(t){var u=t.get(0).id,i=n(t.find("span")[0]),r=n("#"+u+"-links");i.removeClass(o);i.addClass(s);r.removeClass(o);r.addClass(s)}function lt(){var t=function(){n("li.epm-nav-node").find("a").each(function(){var t=n(this),i,r;t.attr("title")||(i=t.find("span"),i&&(n.browser.msie?(r=t.clone().css({display:"inline",width:"auto",visibility:"hidden"}).appendTo("body"),r.width()+i.offset().left+15>t.width()&&t.attr("title",i.text()),r.remove()):t.width()<i.width()&&t.attr("title",i.text())))})};n(".epm-nav-cat").click(function(){var t=n(this),i=n(t.find("span")[0]);i.hasClass(s)?ft(t):b(t);ct(t.parent())});n("#epm-nav-top li").click(function(){t()});t()}function at(i,r,u,f,e,o){var l=function(i,r){var u=function(t,i){var r=n("#"+t);r.fadeOut(300,function(){r.remove()});v&&SP.UI.Notify.removeNotification(i)};t.execute("RemoveNavigationLink",i,function(){u(i,r)},function(){u(i,r)})},y=window.epmLiveNavigation.currentWebUrl,k=(y+"/_layouts/15/epmlive/gridaction.aspx?webid="+r+"&listid="+u+"&id="+f+"&").replace(/\/\//g,"/"),rt=(y+"/_layouts/15/epmlive/redirectionproxy.aspx?webid="+r+"&listid="+u+"&id="+f+"&").replace(/\/\//g,"/"),s="",c,h,tt,it,v;switch(e){case"nav:add":s=rt+"action=new";break;case"nav:team":var d="",g="",p="";if(f!=="undefined")try{c=window.epmLiveNavigation.wsTeamDict[r].split(".");c[2]!=="-1"&&(d=c[0],g=c[1],p=c[2])}catch(ut){}s=(y+"/_layouts/15/epmlive/gridaction.aspx?").replace(/\/\//g,"/")+"action=buildteam&webid="+(d||r);p&&(s=s+"&listid="+g+"&id="+p)}!s&&e&&(s=e.indexOf("epkcommand:")!==-1?k+"action=epkcommand&subaction="+e.split(":")[1]:k+"action="+e);switch(o){case"0":OpenCreateWebPageDialog(s);break;case"1":location.href=s;break;case"2":window.open(s+"&IsDlg=1","","height=100, width=200, toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, directories=no, status=yes");break;case"3":window.open(s+"&IsDlg=1","","width="+screen.width+",height="+screen.height+",top=0,left=0, toolbar=no, menubar=no, scrollbars=yes, resizable=yes,location=no, directories=no, status=yes");break;case"5":SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:s,width:600,height:500});break;case"6":SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:s,showMaximized:!0});break;case"98":if(e!=="nav:addToFav")e!=="nav:remove"&&e!=="nav:removeFavWS"?n.get(s).always(function(){l(i)}):(e==="nav:removeFavWS"&&n("#epm-nav-sub-workspaces-static-links").find("a").each(function(){var t=n(this);t.data("webid")===r&&(i=t.parent().get(0).id)}),l(i),e==="nav:remove"&&(h=n("#"+i).find("a"),window.Analytics.turnOffFav({siteid:h.data("siteid"),webid:h.data("webid"),listid:h.data("listid"),itemid:h.data("itemid"),url:h.get(0).href})));else{var nt=n(n("#"+i).find("a").get(0)),w=nt.text(),b=nt.attr("href"),a=window.epmLive;u=u==="undefined"?null:u;f=f==="undefined"?null:f;tt=f===null?"False":"True";it='<Data><Param key="SiteId">'+a.currentSiteId+'<\/Param><Param key="WebId">'+r+'<\/Param><Param key="ListId">'+u+'<\/Param><Param key="ListViewUrl"><\/Param><Param key="ListIconClass"><\/Param><Param key="ItemId">'+f+'<\/Param><Param key="FString">'+b+'<\/Param><Param key="Type">4<\/Param><Param key="UserId">'+a.currentUserId+'<\/Param><Param key="Title">'+w+'<\/Param><Param key="FileIsNull"><\/Param><Param key="IsItem">'+tt+"<\/Param><\/Data>";t.execute("AddFavoritesWs",it,function(){window.epmLiveNavigation.registerLink({id:r,title:w,url:b,category:null,cssClass:null,order:null,siteId:a.currentSiteId,webId:r,listId:u,itemId:f,external:!1,visible:!0,active:!0,seprator:!1,kind:3})},function(){window.epmLiveNavigation.registerLink({id:r,title:w,url:b,category:null,cssClass:null,order:null,siteId:a.currentSiteId,webId:r,listId:u,itemId:f,external:!1,visible:!0,active:!0,seprator:!1,kind:3})})}break;case"99":confirm("Are you sure you want to send the item(s) to the Recycle Bin?")&&(v=SP.UI.Notify.addNotification("Deleting Item...",!0,"",null),e!=="nav:remove"?n.get(s).always(function(){l(i,v)}):l(i,v));break;default:SP.SOD.execute("SP.UI.Dialog.js","SP.UI.ModalDialog.showModalDialog",{url:s,width:700})}}function vt(){var b=window.TreeView_HoverNode,k=window.TreeView_UnhoverNode,d=window.TreeView_ToggleNode,e,a,i,t,y,p,o;window.TreeView_HoverNode=function(t,i){var r=n(i);r.hasClass(nt)?r.parent().parent().parent().addClass(tt):b(t,i)};window.TreeView_UnhoverNode=function(t){var i=n(t);i.hasClass(nt)?n(t).parent().parent().parent().removeClass(tt):k(t)};window.TreeView_ToggleNode=function(t,i,r,u,f){var p=null,e=n.parseJSON(n.cookie(h)),o,a,k,v,s;e&&(e=n.parseJSON(n.cookie(h))["epm-nav-sub-ql"],e&&(p=e));var w=p||{},c=null,b=n(r).parents("div");for(o=0;o<b.length;o++)if(a=b[o],k=n(a),k.hasClass("epm-nav-sub")){for(c=a.id,v=l(c),s=0;s<v.length;s++){var g=v[s],y=n(g).is(":visible"),nt=g.id.replace("Nodes","");nt===r.id&&(y=!y);w[n("#"+nt.replace("EPMLiveNavn","EPMLiveNavt")).text()]=y}break}ut(c,w);d(t,i,r,u,f)};window.epmLiveNavigation.handleContextualCommand=function(n,t,i,r,u,f){at(n,t,i,r,u,f)};n("td.epm-nav-node-root").click(function(){var i=n(this),t=i.parent().find("a").get(0).id;TreeView_ToggleNode(EPMLiveNav_Data,0,document.getElementById(t)," ",document.getElementById(t+"Nodes"))});e=["suiteBar","s4-ribbonrow","s4-workspace"];for(a in e)n("#"+e[a]).click(function(){r.data("pinstate")==="unpinned"&&rt()});i=n("#epm-nav-pin");i.click(function(){window.epmLiveNavigation.togglePinned(!0)});r.hover(function(){i.show()},function(){i.hide()});try{r.slimScroll({height:r.height(),width:r.width()})}catch(ft){}t=n("#epm-nav").find(".slimScrollDiv");y=t.find(".slimScrollBar");t.css("position","absolute");t.css("left","50px");r.css("left","0");y.css("z-index",1001);n(window).resize(function(){var i=n("#epm-nav-top").height();t.height(i);r.height(i)});n("a.epm-nav-node").click(function(){var i=n(this),r,t,s;n("#epm-nav-sub-ql").find("a").each(function(){n(this).parent().parent().parent().parent().removeClass(f)});i.parent().parent().parent().parent().addClass(f);var u=-1,e=i.parents("div")[0],o=n(e).siblings("div");if(o)for(r=l(n(o[0]).parent().parent().attr("id")),t=0;t<r.length;t++)s=r[t],s.id===e.id&&(u=t);n.cookie(v,JSON.stringify({index:u,uri:i.attr("href")}),c)});window.epmLiveNavigation.snWidth=r.width();o=function(){var t=window.epmLiveNavigation.workspaceTree();t?p=n("#"+t._element.id):window.setTimeout(function(){o()},1)};o();var u=r.width(),w=function(){var i,t;n("a.rtIn").each(function(){var t=n(this);t.attr("style","")});n(".epm-nav-ws-node").each(function(){n(this).attr("style","")});i=0;try{i=p.width()}catch(f){}t=0;u<i&&(t=i+20+20,r.stop().animate({width:t},300),r.parent().stop().animate({width:t},300));n(".epm-nav-ws-node").each(function(){var i=n(this),r=50+(t===0?u:t)-i.offset().left;i.attr("style","width:"+r+"px")});window.epmLiveNavigation.wsTreeExpanded=!0},s=function(){r.stop().animate({width:u},300);r.parent().stop().animate({width:u},300);n(".epm-nav-ws-node").each(function(){n(this).attr("style","")});window.epmLiveNavigation.resetWSNodeWidth();window.epmLiveNavigation.wsTreeExpanded=!1},g=function(n){var r=n.attr("class").toLowerCase(),t,i;r.indexOf("plus")!==-1?(t=function(){n.attr("class").toLowerCase().indexOf("minus")!==-1?window.setTimeout(function(){w()},100):window.setTimeout(function(){t()},1)},t()):(i=function(){n.attr("class").toLowerCase().indexOf("plus")!==-1?window.setTimeout(function(){s()},100):window.setTimeout(function(){i()},1)},i())},it=n("#epm-nav-sub-workspaces");n("#EPMNavWorkspacesTree").hover(function(){window.epmLiveNavigation.wsTreeExpanded||w()},function(){s()});r.hover(function(){},function(){it.is(":visible")&&s()});n("a.rtIn").each(function(){var i=n(this).parent().parent().find("span"),t;i.length>1&&(t=n(i.get(1)),t&&(t.click(function(){g(n(this))}),t.hover(function(){window.epmLiveNavigation.wsNodeSelectorClass=n(this).attr("class")})))})}function k(t){var c,r,f,l,e,s,o,h,a,v;window.epmLiveNavigation.buildLink=function(n){var t=i.currentWebUrl(),r=t+window.location.href.split(t)[1];return{id:n["@Id"],title:n["@Title"],url:(n["#cdata"]||"").replace(/{page}/g,r),category:n["@Category"],cssClass:n["@CssClass"],order:parseInt(n["@Order"]),siteId:n["@SiteId"],webId:n["@WebId"],listId:n["@ListId"],itemId:n["@ItemId"],external:n["@External"]==="True",visible:n["@Visible"]==="True",active:n["@Active"]==="True",seprator:n["@Separator"]==="True"}};c=!1;for(r in t.Nodes){f=t.Nodes[r].NavLink;f.length||(f=[f]);for(l in f)for(e=f[l],s=0;s<u.length;s++)if(o=u[s],o.provider===r)if(r!=="Workspaces")o.registerLink(window.epmLiveNavigation.buildLink(e));else try{h=window.epmLiveNavigation.workspaceTree();h.trackChanges();a=e["@Title"];c?o.registerWorkspace(window.epmLiveNavigation.buildLink(e),h):(o.registerLink(window.epmLiveNavigation.buildLink(e)),a==="All Workspaces"&&(c=!0,n("#epm-nav-sub-workspaces-static-links").remove().insertBefore("#EPMNavWorkspacesTree")));h.commitChanges()}catch(y){}r==="Workspaces"?(window.epmLiveNavigation.resetWorkspaceTree=function(){var n,r,t;try{for(n=window.epmLiveNavigation.workspaceTree(),n.trackChanges(),r=n.get_allNodes(),t=0;t<r.length;t++)r[t].set_expanded(!1);var u=function(t){var r=n.findNodeByValue(t),i;r&&r!=n&&(i=r.get_parent(),i===n||i.get_expanded()||(i.set_expanded(!0),u(i.get_value())))},f=window.epmLiveNavigation.currentWebId,i=n.findNodeByValue(f);i&&(i.get_parent()!==n?u(f):i.set_expanded(!0),i.set_selected(!0));n.commitChanges()}catch(e){}},v=window.epmLiveNavigation.workspaceTree(),n("a.rtIn").each(function(){var t=n(this),i=t.parent(),r=t.text(),u=v.findNodeByText(r).get_value();i.append('<div id="'+u+'" class="epm-nav-ws-node"><\/div>');t.remove();t.text("");t.append("<span>"+r+"<\/span>");window.epmLiveNavigation.wsInfoDict[u].hasAccess||t.addClass("epm-nav-ws-disabled");i.find(".epm-nav-ws-node").append(t)}),window.epmLiveNavigation.resetWorkspaceTree(),n("#EPMNavWorkspacesTree").fadeIn(300)):r==="Applications"?n(n("#epm-nav-sub-new-static-links").find(".epm-nav-sub-header").get(0)).attr("style","padding-top: 0px !important"):r==="Favorites"&&n(n("#epm-nav-sub-favorites-static-links").find(".epm-nav-sub-header").get(0)).attr("style","padding-top: 0px !important");window.SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("EPMLiveNavigation_"+r);r!=="Settings"&&w(r)}}function yt(){for(var r=[],f,i,n=0;n<u.length;n++)f=u[n],i=f.provider,i&&i!==window.epmLiveNavigation.selectedNode&&r.push(i);r.length>0&&t.execute("GetNavigationLinks",r.join(),function(n){k(n);lt()},function(n){console.log(n)})}function d(){var t=null,n;window.epmLiveNavigation&&(t=window.epmLiveNavigation.staticProvider);t?(n=i.parseJson(e.decode(t)),n.Nodes.Workspaces?window.epmLiveNavigation.workspaceTree()?k(n):window.setTimeout(function(){d()},1):k(n)):window.setTimeout(function(){d()},1)}function pt(){n("#epm-nav-top").find("[data-role='top-nav-node']").each(function(){u.push(new ot(this))})}var g=300,nt="epm-nav-node",tt="epm-nav-node-hover",a="epm-nav-node-opened",f="epm-nav-node-selected",o="epm-nav-node-expanded",s="epm-nav-node-collapsed",it="epmnav-selected-tlnode",v="epmnav-selected-link",h="epmnav-expand-state",y="epmnav-pin-state",c={expires:365,path:"/"},r=n("#epm-nav-sub"),u=[],ot=function(t){var o={},l=t,i=n(t),e=n("#epm-nav-sub-"+i.data("id")),s=l.id,tt=i.data("linkprovider"),p=function(){return i.parent().hasClass(f)},rt=function(){return i.parent().hasClass(a)},w=function(n){n?i.parent().addClass(f):i.parent().removeClass(f)},b=function(){e.hide();i.parent().removeClass(a)},k=function(){r.is(":visible")&&r.hide("slide",{direction:"left"},g);b()},ut=function(n,t){var i=new window.Telerik.Web.UI.RadTreeNode,r=t,u,f,e;n.category&&(r=t.findNodeByValue(n.category)||r);i.set_text(n.title);i.set_value(n.webId);n.active?i.set_navigateUrl(n.url):i.set_navigateUrl("javascript:;");window.epmLiveNavigation.wsTeamDict=window.epmLiveNavigation.wsTeamDict||{};window.epmLiveNavigation.wsTeamDict[n.webId]=n.itemId;u=n.itemId.split(".");f="";try{f=u[1]}catch(o){}e="";try{e=u[2]}catch(o){}window.epmLiveNavigation.wsInfoDict=window.epmLiveNavigation.wsInfoDict||{};window.epmLiveNavigation.wsInfoDict[n.webId]={siteId:n.siteId,listId:f,itemId:e,hasAccess:n.active};r.get_nodes().add(i)},ft=function(n){n.seprator?ht(n.category):n.url.toLowerCase()==="header"?(h(n.category),ot(n)):n.url.toLowerCase()==="placeholder"?(h(n.category),et(n)):(h(n.category),st(n))},et=function(n){var t=n.category,i;t||(t="__STATIC__");i='<li class="epm-nav-sub-placeholder">'+n.title+"<\/li>";o[t].$el.append(i)},ot=function(n){var t=n.category,r,i;t||(t="__STATIC__");r="epm-nav-sub-header";e.find("li.epm-nav-section-header").length===0&&(r="epm-nav-section-header");i='<li class="'+r+'">'+n.title+"<\/li>";o[t].$el.append(i);i='<li class="epm-nav-sub-header-bottom"><\/li>';o[t].$el.append(i)},st=function(t){var u=t.category,s,h,e,l,i,a,y,w,p;for(u||(u="__STATIC__"),s=!1,h=t.cssClass.split(" "),e=0;e<h.length;e++)if(h[e]==="epm-nav-button"){s=!0;t.cssClass=t.cssClass.replace(/epm-nav-button/g,"");break}l="";t.cssClass&&(l='<span class="epm-nav-icon '+t.cssClass+'"><\/span>');i="epm-nav-node epm-nav-trans";a=o[u].$el.parent().get(0).id;(a==="epm-nav-sub-settings"||a==="epm-nav-sub-workplace")&&(i="epm-nav-node");s&&(i=i+" epm-nav-button",i=i.replace(/epm-nav-trans/g,""));y="";t.external&&(y=' target="_blank"');w='<li id="'+t.id+'" class="'+i+'" style="display:none;">'+l+'<a id="epm-nav-link-'+t.id+'" href="'+t.url+'" data-siteid="'+t.siteId+'" data-webid="'+t.webId+'" data-listid="'+t.listId+'" data-itemid="'+t.itemId+'"'+y+"><span>"+t.title+"<\/span><\/a><\/li>";o[u].$el.append(w);p=n("#"+t.id);t.visible&&p.show();p.find("a").click(function(){var t=n(this),i=t.parent();if(!i.hasClass("epm-nav-button")){r.find("a").each(function(){n(this).parent().removeClass(f)});var e="",o="",u=i.parent().get(0).id;u!=="epm-nav-sub-favorites-static-links"&&u!=="epm-nav-sub-recent-static-links"&&u!=="epm-nav-sub-new-static-links"&&(i.addClass(f),e=t.attr("href"),o=t.get(0).id);n.cookie(v,JSON.stringify({id:o,url:e}),c)}})},ht=function(t){var i='<div class="epm-nav-sub-sep"><\/div>';t?n("#"+d(t)).append(i):e.append(i)},h=function(t){if(t||(t="__STATIC__"),!o[t]){var i=d(t),r="epm-nav-node-expanded";t==="__STATIC__"&&(r="epm-nav-node-static");t!=="__STATIC__"&&e.append('<div id="'+i+'" class="epm-nav-node epm-nav-node-root epm-nav-cat"><span class="'+r+'">&nbsp;<\/span><span class="epm-nav-cat-title">'+t+"<\/span><\/div>");e.append('<ul id="'+i+'-links" class="epm-nav-links '+r+'"><\/ul>');o[t]={id:i,$el:n("#"+i+"-links")}}},d=function(n){return e.get(0).id+"-"+n.toLowerCase().replace(/ /g,"-").replace(/_/g,"").replace(/[^\w-]+/g,"").replace(/--/g,"-")},ct=function(){e.fadeIn(300);i.parent().addClass(a)},nt=function(){ct();r.is(":visible")||r.show("slide",{direction:"left"},g)};return i.click(function(){var i,t;if(p())rt()&&n.cookie(y)==="unpinned"?k():nt();else{for(i in u)t=u[i],t.id!==s&&t.selected()&&(t.select(!1),t.close());w(!0);nt();n.cookie(it,s,c)}}),{id:s,provider:tt,selected:p,select:w,close:b,closeNav:k,registerLink:ft,registerWorkspace:ut,el:l,$el:i,$menu:e}},et;return window.epmLiveNavigation.togglePinned=function(n){r.data("pinstate")==="pinned"?window.epmLiveNavigation.unpin(n):window.epmLiveNavigation.pin(n)},window.epmLiveNavigation.pin=function(n){p("pinned",n)},window.epmLiveNavigation.unpin=function(n){p("unpinned",n)},window.epmLiveNavigation.removeLink=function(n){var t=r.find("#epm-nav-link-"+n.id);window.epmLiveNavigation.handleContextualCommand(n.id,t.data("webid"),t.data("listid"),t.data("itemid"),"nav:remove","98")},window.epmLiveNavigation.registerLink=function(i){var e,o,s,f,h;if(i){switch(i.kind){case 0:case 1:e="Favorites";break;case 2:case 3:e="Workspaces"}if(e)if(i.kind!==3){for(o=0;o<u.length;o++)if(s=u[o],s.provider===e){if(i.cssClass="epm-nav-sortable "+i.cssClass,s.registerLink(i),f=r.find("#"+i.id),h=n("#epm-nav-sub-"+e.toLowerCase()+"-static-links"),h.find(".epm-nav-sub-placeholder").each(function(){var u=n(this),t=!1,r=u.text();i.kind===0&&r==="No pages"?t=!0:i.kind===1&&r==="No items"?t=!0:i.kind===2&&r==="No favorite workspace"&&(t=!0);t&&u.remove()}),i.kind<2&&f.find("a").attr("style","width:115px !important;"),i.kind===0||i.kind===2)try{f.remove().insertBefore(n(h.find(".epm-nav-sub-header").get(1)))}catch(c){}i.kind!==2?window.epmLiveNavigation.addFavoritesMenu(f):window.epmLiveNavigation.addFavoriteWSMenu(f);f.addClass("epm-nav-sortable");window.epmLiveNavigation.addDragger(f);f.fadeIn(300);break}}else t.execute("GetNavigationLinks",e,function(t){var l=[],y=t.Nodes.Workspaces.NavLink,p,s,f,i,a,h,c,v,o;for(p in y)if(s=y[p],r.find("#"+s["@Id"]).length===0&&(f=s["@Title"],f!=="Workspaces"&&f!=="New Workspace"&&f!=="Favorite Workspaces"&&f!=="All Workspaces")){for(i=window.epmLiveNavigation.buildLink(s),a=!1,h=0;h<l.length;h++)if(l[h]===i.title){a=!0;break}if(a){for(c=0;c<u.length;c++)if(v=u[c],v.provider===e){o=window.epmLiveNavigation.workspaceTree();o.trackChanges();v.registerWorkspace(i,o);o.commitChanges();n("a.rtIn").each(function(){var t=n(this),r=t.text(),u,f;r===i.title&&(u=t.parent(),u.append('<div id="'+o.findNodeByText(r).get_value()+'" class="epm-nav-ws-node"><\/div>'),t.remove(),t.text(""),t.append("<span>"+r+"<\/span>"),u.find(".epm-nav-ws-node").append(t),f=t.parent(),f.addClass("epm-nav-sortable"),t.attr("style","width:125px !important; position: relative; top: 2px;"),window.epmLiveNavigation.addFavoriteWSMenu(f))});break}}else i.kind=2,window.epmLiveNavigation.registerLink(i),l.push(i.title)}},function(n){console.log(n)})}},et=function(){pt();d();p(n.cookie(y)||"pinned");w();ht();vt();ExecuteOrDelayUntilScriptLoaded(yt,"EPMLive.js")},{init:et,expandProviderNodes:w}}();u.init();var f=function(){var i=function(i,r){var h,y;r=r||[];var u=n(i.find(".epm-nav-contextual-menu").get(0)),a=function(t,f){var a=function(n){switch(n.toLowerCase()){case"nav:remove":case"nav:addtofav":case"nav:removefavws":return"icon-star-6";case"view":return"icon-info";case"edit":return"icon-pencil-2";case"delete":return"icon-close-3";case"approve":return"icon-thumbs-up-4";case"comments":return"icon-bubble-dots";case"buildteam":return"icon-user-plus-3";case"workspace":return"icon-tree-2";default:return"epm-nav-cm-blank"}},c=i.get(0).id,l,s,o,h;t.length&&t.push({title:"--SEP--"});for(l in r)t.push(r[l]);for(u=n(i.find(".epm-nav-contextual-menu").get(0)),n(u.find(".epm-nav-cm-loading").get(0)).remove(),s=0;s<t.length;s++){if(o=t[s],h=f.data("webid"),!h||h==="undefined")try{h=f.parent().get(0).id}catch(v){}o.title==="--SEP--"?s!==t.length-1&&u.append(n('<li class="seprator"><\/li>').hide().fadeIn()):(u.append(n('<li><span class="epm-nav-cm-icon '+a(o.command)+'">&nbsp;<\/span><a href="javascript:epmLiveNavigation.handleContextualCommand(\''+c+"','"+h+"','"+f.data("listid")+"','"+f.data("itemid")+"','"+o.command+"','"+o.kind+'\');" style="width: 136px !important;">'+o.title+"<\/a><\/li>").hide().fadeIn()),u.find("a").click(function(){e()}))}u.hover(function(){window.epmNavHoveredNode=c});n(".epm-nav-node, .epm-nav-ws-node").hover(function(){var n=this.id;window.epmNavHoveredNode=n;n!==c&&window.setTimeout(function(){window.epmNavHoveredNode===n&&e()},200)});n(".epm-nav-links, #EPMNavWorkspacesTree").hover(function(){},function(){window.epmNavHoveredNode=null;window.setTimeout(function(){window.epmNavHoveredNode===null&&e()},200)});n(document).on("click",".epm-nav-dragger",function(){e()})},v=function(){u.fadeIn(200)},e=function(){u.fadeOut(200)},p=function(){u.is(":visible")?e():v()};if(i.find(".epm-nav-contextual-menu").length===0){i.append('<ul class="epm-nav-contextual-menu"><li class="epm-nav-cm-loading"><span>Loading...<\/span><\/li><\/ul>');u=n(i.find(".epm-nav-contextual-menu").get(0));v();var f=n(i.find("a").get(0)),o=f.data("siteid"),s=f.data("webid"),c=f.data("listid"),l=f.data("itemid");o||(s=i.get(0).id,h=window.epmLiveNavigation.wsInfoDict[s],o=h.siteId,c=h.listId,l=h.itemId,f.data("siteid",o),f.data("webid",s),f.data("listid",c),f.data("itemid",l));y="<Request><Params><SiteId>"+o+"<\/SiteId><WebId>"+s+"<\/WebId><ListId>"+c+"<\/ListId><ItemId>"+l+"<\/ItemId><UserId>"+window.epmLive.currentUserId+"<\/UserId><DebugMode>"+window.epmLive.debugMode+"<\/DebugMode><\/Params><\/Request>";t.execute("GetContextualMenuItems",y,function(n){var u=[],t,r,i;if(n.ContextualMenus.Items&&(t=n.ContextualMenus.Items.Item,t))for(t.length||(t=[t]),r=0;r<t.length;r++)i=t[r],u.push({title:i["@Title"],command:i["@Command"],kind:i["@Kind"],imgUrl:i["@ImageUrl"]});a(u,f)},function(){a([],f)})}else p()};return{setupMenu:i}}(),o=function(){var t=function(){var t=function(t){t.find(".epm-nav-cat").each(function(){var t=n(n(this).find("span").get(0));t.removeClass("epm-nav-node-expanded");t.addClass("epm-nav-node-collapsed")});t.find(".epm-nav-links").each(function(){var t=n(this);t.hasClass("epm-nav-node-static")||(t.removeClass("epm-nav-node-expanded"),t.addClass("epm-nav-node-collapsed"))})};return{collapseAll:t}}(),i=n("#epm-nav-sub-settings");t.collapseAll(i);u.expandProviderNodes("Settings")},s=function(){var u=function(){window.epmLiveNavigation.addDragger=function(t){t.prepend('<span class="epm-nav-dragger">&nbsp;<\/span>');t.hover(function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","visible")},function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","hidden")})};window.epmLiveNavigation.addFavoritesMenu=function(t){t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');n(t.find(".epm-menu-btn").get(0)).click(function(){f.setupMenu(t,[{title:"Remove",command:"nav:remove",kind:"98"}])})};var i=function(i){var r=[],u=0;i.find(".epm-nav-node").each(function(){r.push(n(this).get(0).id+":"+ ++u)});r.length&&t.execute("ReorderLinks",r.join(),function(){},function(n){console.log(n)})},r=function(n){window.epmLiveNavigation.addDragger(n)},u=function(n){window.epmLiveNavigation.addFavoritesMenu(n)};return{resetOrder:i,addDragger:r,addMenu:u}}(),r=n("#epm-nav-sub-favorites-static-links"),i;r.find(".epm-nav-sortable").each(function(){var t=n(this).parent();t.addClass("epm-nav-sortable");n(t.find("a").get(0)).attr("style","width:115px !important;");u.addDragger(t);u.addMenu(t)});try{i=n("#epm-nav-sub-favorites");r.sortable({items:"li.epm-nav-sortable",placeholder:"epm-nav-drag-placeholder",start:function(t,r){if(i.is(":visible")){var f=r.item.index(),u="page";f>n(i.find(".epm-nav-sub-header").get(1)).index()&&(u="item");r.item.data("kind",u)}},stop:function(t,r){if(i.is(":visible")){var u=!0,o=r.item.data("kind"),f=r.item.index(),e=n(i.find(".epm-nav-sub-header").get(1)).index();o==="page"?f>e&&(u=!1):f<e&&(u=!1);u||n(n(r.item).parent()).sortable("cancel")}},update:function(){u.resetOrder(r)}});r.disableSelection()}catch(e){}},h=function(){var r=function(){var t=function(n,t){n.index()<t?i(n):r(n)},i=function(t){t.append('<span class="epm-menu-btn"><span class="icon-plus-2"><\/span><\/span>');n(t.find("a").get(0)).attr("style","width:115px !important;");n(t.find(".epm-menu-btn").get(0)).click(function(){var i=n(t.find("a").get(0));window.epmLiveNavigation.handleContextualCommand(null,i.data("webid"),i.data("listid"),null,"nav:add",0)})},r=function(t){n(t.find("a").get(0)).attr("style","width: 115px !important;");t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');n(t.find(".epm-menu-btn").get(0)).click(function(){f.setupMenu(t,[])})};return{addMenu:t}}(),t=n("#epm-nav-sub-recent-static-links"),i;t.find(".epm-nav-sub-header").each(function(){var t=n(this),r=t.text(),u=t.index();r==="Recent Items"&&(i=u)});t.find(".epm-nav-node").each(function(){r.addMenu(n(this),i)})},c=function(){var i=function(){window.epmLiveNavigation.addFavoriteWSMenu=function(t){t.append('<span class="epm-menu-btn"><span class="icon-ellipsis-horizontal"><\/span><\/span>');n(t.find(".epm-menu-btn").get(0)).click(function(){var r=t.get(0).id,i=[],u=null,o=!0,e;t.hasClass("epm-nav-ws-node")?window.epmLiveNavigation.wsInfoDict[r].hasAccess?(e=!1,n("#epm-nav-sub-workspaces-static-links").find("a").each(function(){n(this).data("webid")===r&&(e=!0)}),e?i.push({title:"Remove",command:"nav:removeFavWS",kind:98}):i.push({title:"Add",command:"nav:addToFav",kind:98}),u=r):o=!1:(i.push({title:"Remove",command:"nav:removeFavWS",kind:98}),u=n(t.find("a").get(0)).data("webid"));o&&(window.epmLiveNavigation.wsTeamDict[u]!=="X"&&i.push({title:"Edit team",command:"nav:team",kind:6}),f.setupMenu(t,i))})};var e=function(i){var r=[],u=0;i.find("li.epm-nav-sortable").each(function(){r.push(n(this).get(0).id+":"+ ++u)});r.length&&t.execute("ReorderLinks",r.join(),function(){},function(n){console.log(n)})},o=function(t){t.prepend('<span class="epm-nav-dragger">&nbsp;<\/span>');t.hover(function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","visible")},function(){n(n(this).find(".epm-nav-dragger").get(0)).css("visibility","hidden")})},s=function(n){var t=window.epmLiveNavigation.wsInfoDict[n.get(0).id];t?t.hasAccess&&window.epmLiveNavigation.addFavoriteWSMenu(n):window.epmLiveNavigation.addFavoriteWSMenu(n)},h=function(){window.epmLiveNavigation.resetWSNodeWidth=function(){n("a.rtIn").each(function(){var t=n(this),o=n(t.find("span").get(0)),r=15,u=o.width();if(u){var f=t.offset().left-50,s=u+f,e=180,i=e-f-r;t.data("originalwidth",t.width());t.data("newwidth",i);s>e-r?t.width(i):t.parent().width(i)}})};window.epmLiveNavigation.resetWSNodeWidth()},i=function(){if(n.fn.bindWithDelay){var t=n("#EPMNavWSTSearch");t.val("");t.bindWithDelay("keyup",function(){var t=n(this).val().trim();t?t.length>1?c(t.toLowerCase()):r():r()},200)}else window.setTimeout(function(){i()},100)},c=function(t){for(var o=window.epmLiveNavigation.workspaceTree().get_allNodes(),s=!1,i,f,e,r=0;r<o.length;r++)i=o[r],f=i.get_text().trim(),f&&f.toLowerCase().indexOf(t)!==-1?(u(i),i.set_visible(!0),s=!0,e=n("#EPMNavWorkspacesTree").find("div.epm-nav-sub-placeholder"),e.length>0&&n(e.get(0)).remove()):i.set_visible(!1);s||n("#EPMNavWorkspacesTree").append(n('<div class="epm-nav-sub-placeholder">No search results<\/div>').hide().fadeIn(200))},r=function(){for(var t=window.epmLiveNavigation.workspaceTree().get_allNodes(),n=0;n<t.length;n++)t[n].set_visible(!0);window.epmLiveNavigation.resetWorkspaceTree()},u=function(n){var t=n.get_parent();t&&t!==window.epmLiveNavigation.workspaceTree()&&(t.set_visible(!0),t.set_expanded(!0),u(t))};return{resetOrder:e,addDragger:o,addMenu:s,initializeSearch:i,configureNodeWidth:h}}(),r=n("#epm-nav-sub-workspaces-static-links");r.find(".epm-nav-sortable").each(function(){var t=n(this).parent();t.addClass("epm-nav-sortable");n(t.find("a").get(0)).attr("style","width:125px !important; position: relative; top: 2px;");i.addDragger(t);i.addMenu(t)});try{r.sortable({items:"li.epm-nav-sortable",placeholder:"epm-nav-drag-placeholder",update:function(){i.resetOrder(r)}});r.disableSelection()}catch(u){}i.configureNodeWidth();i.initializeSearch();n("#EPMNavWorkspacesTree").find("a").each(function(){i.addMenu(n(this).parent())})};ExecuteOrDelayUntilScriptLoaded(o,"EPMLiveNavigation_Settings");ExecuteOrDelayUntilScriptLoaded(s,"EPMLiveNavigation_Favorites");ExecuteOrDelayUntilScriptLoaded(c,"EPMLiveNavigation_Workspaces");ExecuteOrDelayUntilScriptLoaded(h,"EPMLiveNavigation_RecentItems");window.SP.SOD.notifyScriptLoadedAndExecuteWaitingJobs("EPMLive.Navigation.js")})}function t(){ExecuteOrDelayUntilScriptLoaded(n,"EPMLiveNavigation")}ExecuteOrDelayUntilScriptLoaded(t,"jquery.min.js")})();
//# sourceMappingURL=EPMLive.Navigation.min.js.map