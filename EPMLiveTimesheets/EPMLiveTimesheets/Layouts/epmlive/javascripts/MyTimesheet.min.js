function TSOnLoaded(grid){var newgridid=grid.id.substr(2),newobj=eval("TSObject"+newgridid);grid.Lang.Format.DecimalSeparator=newobj.DecimalSeparator;grid.Lang.Format.GroupSeparator=newobj.GroupSeparator}function TMFilter(n,t){var i=Grids["TS"+n];t==1?i.ChangeFilter("","",""):t==2?i.ChangeFilter("Submitted","1","2",0,0):t==3&&i.ChangeFilter("Submitted,Approved","1,1","1,2",0,0);$("#ddlFilterControl_ul_menu").toggle()}function EmailTSA(gridid){var grid=Grids["TS"+gridid],rows=grid.GetSelRows(),rowstring="";for(var row in rows)rowstring+=","+rows[row].ResId;rowstring.length>2&&(rowstring=rowstring.substr(1));var webUrl=window.epmLiveNavigation.currentWebUrl,newgridid=grid.id.substr(2),newobj=eval("TSObject"+newgridid),url=webUrl+"/_layouts/epmlive/sendtsemail.aspx?period="+newobj.CurPeriodId+"&resources="+rowstring,options={url:url,width:600,title:"Send Email",autoSize:!1};SP.UI.ModalDialog.showModalDialog(options)}function Approve(n){ProcessApprovals(n,"1")}function Reject(n){ProcessApprovals(n,"2")}function Unlock(n){ProcessApprovals(n,"0")}function ProcessApprovals(n,t){var r=Grids["TS"+n],i=r.GetSelRows(),f,u;if(i.length<=0)alert("You must select 1 or more rows");else{f="";for(u in i)i[u].Submitted=="1"&&(f+='<TS id="'+i[u].id+'">'+r.GetValue(i[u],"ApprovalNotes")+"<\/TS>");ShowMessage(r.id,"Processing Timesheets...",200,50);EPMLiveCore.WorkEngineAPI.Execute("timesheet_ApproveTimesheets",'<Approve ApproveStatus="'+t+'">'+f+"<\/Approve>",function(n){if(n=parseJson(n),n.Result["@Status"]=="0")for(var u in i)i[u].Submitted=="1"&&(r.SetValue(i[u],"Approved",t,1),r.RefreshCell(i[u],"TMApproval"));else alert(n.Result.Error["#text"]);HideMessage(r.id)})}}function GetTSGridId(n){return n.id.substr(2)}function LoadTSGrid(gridid){EPM.UI.Loader.current().startLoading({id:"WebPart"+eval("TSObject"+gridid+".Qualifier")})}function TSReady(n){var t=GetTSGridId(n);GridType=="0"?(TGSetEvent("OnDblClickRow",n.id,TSDoubleClick),TGSetEvent("OnFocus",n.id,TSOnFocus)):TGSetEvent("OnFocus",n.id,TSAOnFocus);TGSetEvent("OnGetHtmlValue",n.id,MYTSOnGetHtmlValue);TGSetEvent("OnMouseOutRow",n.id,TSOnMouseOutRow);TGSetEvent("OnMouseOverOutside",n.id,TSOnMouseOverOutside);TGSetEvent("OnMouseOverRow",n.id,TSOnMouseOverRow);TGSetEvent("OnClick",n.id,TSGridClick);TGSetEvent("OnAfterValueChanged",n.id,TSGridOnAfterValueChanged);TGSetEvent("OnSave",n.id,TSSave)}function TSSave(n,t){var t=n.GetRowById("-1"),i=!0;for(var r in TSDCols){var u=parseFloat(n.GetValue(t,r)),f=TSDCols[r].split("|"),e=parseFloat(f[0]),o=parseFloat(f[1]);u>o&&(alert("On "+n.GetValue(n.GetRowById("Header"),r).replace("<br>"," ")+": "+u+" is greater than max of "+o),i=!1);u<e&&(alert("On "+n.GetValue(n.GetRowById("Header"),r).replace("<br>"," ")+": "+u+" is smaller than min of "+e),i=!1)}return i?TimesheetHoursEdited=!1:HideMessage(n.id),!i}function TSGridClick(n,t,i){if(n.EditRow&&StopEditGridRow(n,t),NotesOut&&curCol!=i){NotesOut=!1;curPop=!1;var r=document.getElementById("NotesDiv");r.style.display="none"}curPop||DoPopUp(n,t,i)}function TSGridOnAfterValueChanged(n,t,i){n.Cols[i].Sec==0?TimesheetItemEdited=!0:TimesheetHoursEdited=!0}function StopEditCols(n,t){for(var i in n.Cols)n.Cols[i].Sec==0&&n.SetAttribute(t,i,"CanEdit","0",1);n.SetAttribute(t,"Title","HtmlPrefix","",1);n.EditRow="";TimesheetItemEdited=!1}function GetOtherHours(n,t){n.SetAttribute(t,"Title","HtmlPrefix","<img src='/_layouts/15/epmlive/images/mywork/loading16.gif'>",1);var i=window.epmLiveNavigation.currentWebUrl,r='<Timesheet List="'+t.ListID+'" ID="'+t.ItemID+'"/>';$.ajax({type:"POST",url:(i+"/_vti_bin/WorkEngine.asmx/ExecuteJSON").replace(/\/\//g,"/"),data:"{ Function: 'timesheet_GetOtherHours', Dataxml: '"+r+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(response){var oResp=eval("("+response.d+")");oResp.GetOtherHours.Status=="0"?n.SetValue(t,"TSOtherHours",oResp.GetOtherHours.Text,1,0):alert(oResp.GetOtherHours.Text);n.SetAttribute(t,"Title","HtmlPrefix","",1)},error:function(i){alert("Error: "+i);n.SetAttribute(t,"Title","HtmlPrefix","",1)}})}function StopEditGridRow(n,t){var t,r,u,i,f,e;if(t.id!=n.EditRow)if(t=n.GetRowById(n.EditRow),n.EditRow=null,n.EndEdit(!0),TimesheetItemEdited){n.SetAttribute(t,"Title","HtmlPrefix","<img src='/_layouts/15/epmlive/images/mywork/loading16.gif'>",1);r="";u="";for(i in n.Cols)n.Cols[i].Sec==0&&(n.GetAttribute(t,i,"CanEdit")=="1"&&i!="G"&&i!="Timesheet"&&(r+='<Field Name="'+i+'">'+n.GetValue(t,i)+"<\/Field>"),u+=","+i);f='<Row id="'+t.id+'" siteid="'+t.SiteID+'" webid="'+t.WebID+'" listid="'+t.ListID+'" itemid="'+t.ItemID+'" Cols="'+u+'">'+r+"<\/Row>";e=window.epmLiveNavigation.currentWebUrl;$.ajax({type:"POST",url:(e+"/_vti_bin/WorkEngine.asmx/ExecuteJSON").replace(/\/\//g,"/"),data:"{ Function: 'webparts_SetGridRowEdit', Dataxml: '"+f+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(response){var oResp=eval("("+response.d+")");oResp.Result.Status=="0"?n.AddDataFromServer(oResp.Result.InnerText):alert(oResp.Result.Error.Text);n.SetAttribute(t,"Title","HtmlPrefix","",1);StopEditCols(n,t)},error:function(i){alert("Error: "+i);n.SetAttribute(t,"Title","HtmlPrefix","",1)}})}else StopEditCols(n,t)}function TSOnFocus(n,t,i){curRow||(curRow=t);DoPopUp(n,t,i);t.ItemID&&(n.ActionClearSelection(),n.SelectRow(t));RefreshCommandUI()}function TSAOnFocus(n,t,i){curRow||(curRow=t);DoPopUp(n,t,i)}function TSOnMouseOverOutside(n){n.CurHoverRow&&n.SetAttribute(n.GetRowById(n.CurHoverRow),"Title","ButtonText"," ",1);n.CurHoverRow="0"}function TSOnMouseOverRow(n,t){n.CurHoverRow!=t.id&&(n.CurHoverRow=t.id,CurrentGrid=n,n.GetValue(t,"ItemID")!=""&&(n.SetAttribute(t,"Title","ButtonText",'<div class="gridmenuspan" style="position:absolute;overflow:visible" id="'+t.id+'"><a data-itemid="'+n.GetValue(t,"ItemID")+'" data-listid="'+n.GetValue(t,"ListID")+'" data-webid="'+n.GetValue(t,"WebID")+'" data-siteid="'+n.GetValue(t,"SiteID")+'" ><\/a><\/div>',1),window.epmLiveNavigation.addContextualMenu($("#"+t.id),[],!1,!0,{"delete":"GridGanttDeleteRow"})))}function TSOnMouseOutRow(n,t){n.SetAttribute(t,"Title","ButtonText"," ",1)}function TSDoubleClick(grid,row,col){var newgridid=grid.id.substr(2),newobj=eval("TSObject"+newgridid);newobj.Status=="Unsubmitted"&&EditGridRow(grid,row,col)}function EditGridRow(n,t){var r,i,u,f;if(t.ItemID){r=window.epmLiveNavigation.currentWebUrl;i="";for(u in n.Cols)i+=","+u;i=i.substr(1);f='<Row id="'+t.id+'" siteid="'+t.SiteID+'" webid="'+t.WebID+'" listid="'+t.ListID+'" itemid="'+t.ItemID+'" Cols="'+i+'"/>';n.SetAttribute(t,"Title","HtmlPrefix","<img src='/_layouts/15/epmlive/images/mywork/loading16.gif'>",1);$.ajax({type:"POST",url:(r+"/_vti_bin/WorkEngine.asmx/ExecuteJSON").replace(/\/\//g,"/"),data:"{ Function: 'webparts_GetGridRowEdit', Dataxml: '"+f+"' }",contentType:"application/json; charset=utf-8",dataType:"json",success:function(response){var oResp=eval("("+response.d+")");oResp.Result.Status=="0"?(n.EditRow=t.id,n.AddDataFromServer(oResp.Result.InnerText),n.SetAttribute(t,"Title","HtmlPrefix",'<span class="icon-pencil" style="color: #CCC;padding-right:5px"><\/span>',1),n.StartEdit()):alert(oResp.Result.Error.Text)},error:function(n){alert("Error: "+n)}})}}function TSRenderFinish(grid){var gridid=GetTSGridId(grid);if(EPM.UI.Loader.current().stopLoading("WebPart"+eval("TSObject"+gridid+".Qualifier")),document.getElementById("tsnav").style.display="inline-block",curGrid=grid,GridType=="0"){if(grid.id.substr(0,2)=="TS"){clickTab();RefreshStopWatch();CheckSaveStatus(grid.id);StartCheckApproveStatus(grid.id);$(".TS_Comments").click(function(){showComments(grid.id)});try{$("#tssw").tooltip()}catch(e){}ShowApprovalNotification();window.onbeforeunload=leavePage}}else{eval("loadMenu"+grid.id.substr(2)+"()");try{$("#tsan").tooltip()}catch(e){}}SetGridSize()}function esGrid(){curPop&&(curGrid.EndEdit(!1),curGrid.StartEdit())}function showribbon(){var n=document.getElementById("Ribbon.MyTimesheetTab-title");n&&fireEvent(n.firstChild,"click")}function responseIsSuccess(n){return n.Result["@Status"]==0}function parseJson(response){return eval("("+xml2json(parseXml(response),"")+")")}function parseXml(n){var t=null;if(window.DOMParser)try{t=(new DOMParser).parseFromString(n,"text/xml")}catch(i){t=null}else if(window.ActiveXObject)try{t=new ActiveXObject("Microsoft.XMLDOM");t.async=!1;t.loadXML(n)}catch(i){t=null}return t}function CheckSaveStatus(n){var t=Grids[n];EPMLiveCore.WorkEngineAPI.ExecuteJSON("timesheet_CheckSaveStatus",'<Timesheet ID="'+t.TimesheetUID+'" />',function(response){var oResponse=eval("("+response+")"),status,newgridid,newobj;if(oResponse.SaveStatus.Result=="0"){if(status="",oResponse.SaveStatus.Status=="-1")return;oResponse.SaveStatus.Status=="0"?status="Queued":oResponse.SaveStatus.Status=="2"?status="Processing ("+oResponse.SaveStatus.PercentComplete+"%)":oResponse.SaveStatus.Status=="3"&&(status="Completed");oResponse.SaveStatus.Status=="3"?(oResponse.SaveStatus.ErrorResult=="No Errors"?TSStatusMessage!=null&&(SP.UI.Status.removeStatus(TSStatusMessage),TSStatusMessage=null):(SP.UI.Status.setStatusPriColor(TSStatusMessage,"red"),SP.UI.Status.updateStatus(TSStatusMessage,"Error: "+oResponse.SaveStatus.ResultText)),bTSSaving&&(bTSSaving=!1,RefreshCommandUI()),bSaveAndSubmit&&(bSaveAndSubmit=!1,StartCheckApproveStatus(n),newgridid=t.id.substr(2),newobj=eval("TSObject"+newgridid),newobj.Status="Submitted",document.getElementById("mytimesheetstatus").innerHTML="Submitted",RefreshCommandUI())):(bTSSaving||(bTSSaving=!0,RefreshCommandUI()),TSStatusMessage==null?(TSStatusMessage=SP.UI.Status.addStatus("Save Status:",status,!0),SP.UI.Status.setStatusPriColor(TSStatusMessage,"blue")):(SP.UI.Status.updateStatus(TSStatusMessage,status),SP.UI.Status.setStatusPriColor(TSStatusMessage,"blue")),setTimeout("CheckSaveStatus('"+n+"')",2e3))}})}function UnSubmitTimesheet(n){ShowMessage(n,"Unsubmitting...",150,30);var t=Grids[n];EPMLiveCore.WorkEngineAPI.ExecuteJSON("timesheet_UnSubmitTimesheet",'<Timesheet ID="'+t.TimesheetUID+'" />',function(response){var oResponse=eval("("+response+")"),newgridid,newobj;HideMessage(t.id);oResponse.UnSubmitTimesheet.Status=="0"?(newgridid=t.id.substr(2),newobj=eval("TSObject"+newgridid),newobj.Status="Unsubmitted",document.getElementById("mytimesheetstatus").innerHTML="Unsubmitted",EnableAllRows(t),HideMessage(n),AfterUnSubmit(t),RefreshCommandUI()):alert(oResponse.UnSubmitTimesheet.Text)})}function SubmitTimesheet(n){if(StopWatchRow)alert("You have a stopwatch currently running, please stop the stopwatch before you submit");else{var t=Grids[n];TimesheetHoursEdited?(ShowMessage(n,"Saving and Submitting...",180,30),t.SaveAndSubmit="true",bSaveAndSubmit=!0,DisableAllRows(t),t.Save(),TimesheetHoursEdited=!1,HideMessage(t.id),AfterSubmit(t),RefreshCommandUI()):(ShowMessage(n,"Submitting...",140,30),EPMLiveCore.WorkEngineAPI.ExecuteJSON("timesheet_SubmitTimesheet",'<Timesheet ID="'+t.TimesheetUID+'" />',function(response){var oResponse=eval("("+response+")"),newgridid,newobj;HideMessage(t.id);oResponse.SubmitTimesheet.Status=="0"?(newgridid=t.id.substr(2),newobj=eval("TSObject"+newgridid),newobj.Status="Submitted",document.getElementById("mytimesheetstatus").innerHTML="Submitted",DisableAllRows(t),AfterSubmit(t),RefreshCommandUI()):alert(oResponse.SubmitTimesheet.Text);StartCheckApproveStatus(n)}))}}function DisableAllRows(n){var i,t;for(i in n.Rows)t=n.Rows[i],t.Kind=="Data"&&t.id!="-1"&&n.SetAttribute(t,null,"CanEdit",0,!0,!1)}function EnableAllRows(n){var i,t;for(i in n.Rows)t=n.Rows[i],t.Kind=="Data"&&t.id!="-1"&&n.GetValue(t,"TSEnabled")=="1"&&n.SetAttribute(t,null,"CanEdit","1",!0,!1)}function ShowMessage(n,t,i,r){n=n.substr(2);HideMessage(n);spnMsg||(spnMsg=document.getElementById("spnMessage"+n));spnMsg.innerHTML=t;sm("divMessage"+n,i,r)}function HideMessage(n){hm("divMessage"+n)}function StartCheckApproveStatus(n){iApproveInterval&&clearInterval(iApproveInterval);CheckApproveStatus(n);iApproveInterval=setInterval("CheckApproveStatus('"+n+"')",1e4)}function ChangeView(grid,view){var newgridid=grid.id.substr(2),newobj=eval("TSObject"+newgridid),oView=newobj.Views[view],oViewCol,oViewColInfo,i,vCol,oV,ooV,tWidth,dx,filters;oView.Group==""?grid.DoGrouping(null):grid.DoGrouping(oView.Group);var oViewCols=oView.Cols.split(","),sViewCols="",oVisible={};for(oViewCol in oViewCols)oViewCol!="indexOf"&&(oViewColInfo=oViewCols[oViewCol].split("|"),oVisible[oViewColInfo[0]]={},oVisible[oViewColInfo[0]].Width=oViewColInfo.length>1?oViewColInfo[1]:"");var Cols=grid.GetCols(""),Show="",Hide="";for(i=0;i<Cols.length;i++)vCol=grid.Cols[Cols[i]],vCol&&vCol.Sec==0&&(oVisible[vCol.Name]?Show+=","+vCol.Name:Hide+=","+vCol.Name);grid.ChangeColsVisibility(Show.substr(1).split(","),Hide.substr(1).split(","),0);for(oV in oVisible)if(ooV=oVisible[oV],ooV.Width!=""){tWidth=grid.GetAttribute(null,oV,"Width");dx=parseInt(ooV.Width)-tWidth;try{grid.SetWidth(oV,dx)}catch(e){}}oView.Filters==""||oView.Filters=="||"?grid.ChangeFilter("","","",0,0,null):(filters=oView.Filters.split("|"),grid.ChangeFilter(filters[0],filters[1],filters[2],0,0,null));grid.Sort=oView.Sort;grid.SortRows();newobj.CurrentViewId=view;newobj.CurrentView=oView.Name;RefreshCommandUI();grid.Render()}function DeleteView(n,t){ShowMessage(n.id,"Deleting View...",150,50);EPMLiveCore.WorkEngineAPI.ExecuteJSON("timesheet_DeleteView",'<View Name="'+t+'"/>',function(response){var oResponse=eval("("+response+")"),newgridid,newobj,view,oView;if(n.StaticCursor=1,HideMessage(n.id),oResponse.Views.Status=="0"){newgridid=n.id.substr(2);newobj=eval("TSObject"+newgridid);newobj.Views=eval("("+oResponse.Views.Text.replace(/&quot;/g,'"')+")");for(view in newobj.Views)oView=newobj.Views[view];newobj.CurrentView="";newobj.CurrentViewId="";RefreshCommandUI()}else alert(oResponse.Views.Text)})}function RenameView(n,t,i){ShowMessage(n.id,"Renaming View...",150,50);EPMLiveCore.WorkEngineAPI.ExecuteJSON("timesheet_RenameView",'<View Name="'+t+'" NewName="'+i+'"/>',function(response){var oResponse=eval("("+response+")"),newgridid,newobj,view,oView;if(n.StaticCursor=1,HideMessage(n.id),oResponse.Views.Status=="0"){newgridid=n.id.substr(2);newobj=eval("TSObject"+newgridid);newobj.Views=eval("("+oResponse.Views.Text.replace(/&quot;/g,'"')+")");for(view in newobj.Views)if(oView=newobj.Views[view],oView.Name==i){newobj.CurrentView=i;newobj.CurrentViewId=view;break}RefreshCommandUI()}else alert(oResponse.Views.Text)})}function SaveView(n,t){var o,s,i,e;ShowMessage(n.id,"Saving View...",150,50);n.StaticCursor=0;var l=n.GetRowById("Filter"),r="",u="",f="";for(o in n.Cols)s=l[o+"Filter"],s!=null&&s!=0&&(f+=","+s,u+=","+l[o],r+=","+o);f.length>0&&(f=f.substr(1));u.length>0&&(u=u.substr(1));r.length>0&&(r=r.substr(1));var a=r+"|"+u+"|"+f,h=n.GetCols("Visible"),c="";for(i=0;i<h.length;i++)e=n.Cols[h[i]],e&&e.Sec==0&&(c+=e.Name!="Title"?","+h[i]+"|"+e.Width:","+h[i]+"|");c=c.substr(1);EPMLiveCore.WorkEngineAPI.ExecuteJSON("timesheet_SaveView",'<View Name="'+t[0]+'" Default="'+t[1]+'" Filters="'+a+'" Group="'+n.Group+'" Sort="'+n.Sort+'" Cols="'+c+'" Expand="" />',function(response){var oResponse=eval("("+response+")"),newgridid,newobj,view,oView;if(n.StaticCursor=1,HideMessage(n.id),oResponse.Views.Status=="0"){newgridid=n.id.substr(2);newobj=eval("TSObject"+newgridid);newobj.Views=eval("("+oResponse.Views.Text.replace(/&quot;/g,'"')+")");for(view in newobj.Views)if(oView=newobj.Views[view],oView.Name==t[0]){newobj.CurrentView=t[0];newobj.CurrentViewId=view;break}RefreshCommandUI()}else alert(oResponse.Views.Text)})}function CheckApproveStatus(){return;var n}function OpenPMApprovals(n){var r=Grids["TS"+n],t,i;curGrid=r;t=siteColUrl+"/Lists/My%20Timesheet/Project%20Manager%20Approval.aspx";i={url:t,showMaximized:!0,title:"Approvals",autoSize:!1};SP.UI.ModalDialog.showModalDialog(i)}function AutoAddWork(grid){var rows,R,oRow,newgridid,newobj;ShowMessage(grid.id,"Adding Work...",130,30);rows="";for(R in grid.Rows)oRow=grid.Rows[R],oRow.Kind=="Data"&&oRow.Def.Name=="R"&&(rows+=","+oRow.ListID+"."+oRow.ItemID);rows.length>0&&(rows=rows.substr(1));newgridid=grid.id.substr(2);newobj=eval("TSObject"+newgridid);EPMLiveCore.WorkEngineAPI.ExecuteJSON("timesheet_AutoAddWork",'<Timesheet ID="'+grid.TimesheetUID+'" Rows="'+rows+'"  UserId="'+newobj.UserId+'"/>',function(response){var oResponse=eval("("+response+")");oResponse.AutoAddWork.Status=="0"?(HideMessage(grid.id),CheckForUpdate(grid)):(HideMessage(grid.id),alert(oResponse.AutoAddWork.Text))})}function ShowNotes(n,t,i,r,u){var f,o,e,s,h;NotesOut=!0;f=Grids[n];o=f.GetRowById(t);curGrid=f;curRow=o;curCol=i;e=document.getElementById("NotesDiv");e.style.display="";s=document.getElementById("txtNotes");s.value=f.GetValue(o,"TS"+i);s.focus();$("#NotesDiv").appendTo($("body"));h=$("#notesimg");e.style.top=h.offset().top+"px";e.style.left=h.offsetParent().offsetParent().offset().left+"px";stopProp(u)}function DoPopUp(grid,row,col){var image,strDivTag,strTypeDiv,pVal,oVal,iType,oType,notes;if(curRow!=row||curCol!=col||!curPop&&TSColType==2){curPop=!1;curRow&&curRow.Kind=="Data"&&curRow.id!="-1"&&curCol&&TSCols[curCol]&&grid.SetAttribute(curRow,curCol,"HtmlPrefix","",!0,!1);curRow=row;curCol=col;curGrid=grid;var newgridid=grid.id.substr(2),newobj=eval("TSObject"+newgridid),bLocked=!1;if(newobj.Locked&&(bLocked=!0),newobj.Status!="Unsubmitted"&&(bLocked=!0),grid.GetValue(row,"TSEnabled")!="1"&&(bLocked=!0),grid.GetAttribute(row,"CanEdit")=="0"&&(bLocked=!0),row&&row.Kind=="Data"&&row.id!="-1"&&col&&TSCols[col]&&row.Def.Name=="R")if(TSColType==1)TSNotes?(pVal=grid.GetValue(row,"TS"+col),image="tsnonotes",pVal!=""&&(image="tsnotes"),grid.EndEdit(!0),grid.Focus(row,col),grid.StartEdit(),strDivTag="<div style='position: absolute; margin-left: 65px; cursor:pointer; z-index: 999;' onMouseDown=\"stopProp(event);\" onClick=\"ShowNotes('"+grid.id+"','"+row.id+"','"+col+'\',this,event);"><img id="notesimg" class="transparentnotes" src="/_layouts/epmlive/images/'+image+'.png"><\/div>',grid.SetAttribute(row,col,"HtmlPrefix",strDivTag,!0,!1)):setTimeout("curGrid.StartEdit()",100);else if(TSColType==2){try{$("#TypeDivOuter").remove()}catch(e){}curPop=!0;strTypeDiv='<div id=\'TypeDivOuter\' style=\'position: absolute; margin-top: 20px; margin-left: 2px;z-index:999; cursor:default; width:156px; background-color: #F8F8F8; text-align:left;border: 1px solid #AAA; border-radius: 5px; padding:3px;\' onClick="stopProp(event);"><table border="0" cellspacing="3" cellpadding="0">';pVal=grid.GetValue(row,"TS"+col);pVal==""&&(pVal="{}");oVal=eval("("+pVal+")");for(iType in TSTypeObject){oType=TSTypeObject[iType];strTypeDiv+="<tr><td>"+oType+':<\/td><td align="right"><input type="text" class="epmliveinput" onkeydown="stopProp(event);" onkeyup="stopProp(event);" onkeypress="stopProp(event);return isNumberKey(event);" onClick="this.select();stopProp(event);" style="width:25px" id="'+iType+'TypeValue" Value="';try{strTypeDiv+=oVal[iType]?oVal[iType]:"0"}catch(e){}strTypeDiv+='"';bLocked&&(strTypeDiv+=' disabled="disabled"');strTypeDiv+="><\/td><\/tr>"}TSNotes&&(notes="",oVal.Notes&&(notes=oVal.Notes,notes=unescape(notes).replace(/<br>/g,"\r\n")),strTypeDiv+='<tr><td colspan="2"><textarea class="epmliveinput" id=\'txtTNotes\' style=\'width:140px;height:75px;outline:0;resize:none\' ondblclick="stopProp(event);" onkeydown="stopProp(event);" onkeyup="stopProp(event);" onclick="stopProp(event);" onkeypress="stopProp(event);"',bLocked&&(strTypeDiv+=' disabled="disabled"'),strTypeDiv+=">"+notes+"<\/textarea><\/td><\/tr>");strTypeDiv+='<tr><td colspan="2" align="right">';bLocked||(strTypeDiv+='<input type="button" value="OK" class="tsOK" onClick="SaveTypes(event);">&nbsp;');strTypeDiv+='<input type="button" value="Cancel" class="tsOK" onClick="CloseTypes(event);"><\/td><\/tr><\/table><\/div><div style=\'position: absolute; margin-top: -10px; margin-left: -9px \'><img src=\'/_layouts/epmlive/images/tsoutline.png\'><\/div>';grid.SetAttribute(row,col,"HtmlPrefix","<div id='typedivlocation'>",!0,!1);$("body").append(strTypeDiv);var TypeDiveOuter=$("#TypeDivOuter"),oDiv=TypeDiveOuter.get(0),oLocDiv=$("#typedivlocation");oDiv.style.top=oLocDiv.offset().top-28+TypeDiveOuter.height()>$(window).height()?oLocDiv.offset().top-TypeDiveOuter.height()+"px":oLocDiv.offset().top-28+"px";oDiv.style.left=oLocDiv.offset().left-5+"px";setTimeout("curGrid.StartEdit()",100)}}}function isNumberKey(n){var t=n.which?n.which:event.keyCode;return t!=46&&t!=44&&t>31&&(t<48||t>57)?!1:!0}function GetGridId(n){return n.id.substr(2)}function SetGridSize(){var n=document.getElementById("gridouter"),t=GetPageHeight(),i=GetItemTop(n);n.style.height=t-i-35+"px"}function CheckForUpdate(n){var t,u,r,i;curGrid=n;ShowMessage(n.id,"Refreshing Timesheet",180,50);t="";for(u in n.Rows)r=n.Rows[u],r.Kind=="Data"&&r.Def.Name=="R"&&(t+=","+r.UID);t.length>0&&(t=t.substr(1));i="&lt;Param";i+=' ID="'+n.TimesheetUID+'"';i+=' Rows="'+t+'"';i+="/&gt;";n.Data.Check.Param.Dataxml=i;n.CheckForUpdates(CheckedUpdates)}function CheckedUpdates(){var newgridid=curGrid.id.substr(2),newobj=eval("TSObject"+newgridid);ChangeView(curGrid,newobj.CurrentViewId);HideMessage(curGrid.id)}function StopStopWatchClose(oDialogResult){var oSW,SW,iType,fVal;if(oDialogResult==SP.UI.DialogResult.OK)if(TSColType==1)for(SW in StopWatchResponse)SW!="Status"&&(oSW=StopWatchResponse[SW],fVal=parseFloat(curStoppingGrid.GetValue(curStoppingRow,"P"+oSW.DateTicks)),isNaN(fVal)&&(fVal=0),fVal+=parseFloat(oSW.Minutes)/60,curStoppingGrid.SetValue(curStoppingRow,"P"+oSW.DateTicks,parseFloat(fVal.toFixed(2)),1,0));else if(TSColType==2)for(SW in StopWatchResponse)if(SW!="Status"){var oSW=StopWatchResponse[SW],pVal=curStoppingGrid.GetValue(curStoppingRow,"TSP"+oSW.DateTicks),oVal=null;pVal!=""&&(oVal=eval("("+pVal+")"));var fTotal=0,bSet=!1,newTypeVal="";for(iType in TSTypeObject)fVal=0,oVal&&oVal[iType]&&(fVal=oVal[iType]),bSet||(fVal+=parseFloat(oSW.Minutes)/60,bSet=!0),fVal!="NaN"&&fVal!=0&&(newTypeVal+=","+iType+": "+fVal.toFixed(2),fTotal+=fVal);TSNotes&&oVal&&oVal.Notes&&(newTypeVal+=',Notes: "'+oVal.Notes+'"');newTypeVal.length>0&&(newTypeVal=newTypeVal.substr(1));newTypeVal="{"+newTypeVal+"}";curStoppingGrid.SetValue(curStoppingRow,"P"+oSW.DateTicks,parseFloat(fTotal.toFixed(2)),1,0);curStoppingGrid.SetValue(curStoppingRow,"TSP"+oSW.DateTicks,newTypeVal,0,0)}bStopWatchStartWaiting&&(bStopWatchStartWaiting=!1,StartStopWatch(curGrid,curRow))}function StopStopWatch(grid,row){var newgridid=grid.id.substr(2),newobj=eval("TSObject"+newgridid);EPMLiveCore.WorkEngineAPI.ExecuteJSON("timesheet_StopStopWatch",'<StopWatch ID="'+row.UID+'" UserId="'+newobj.UserId+'"/>',function(response){var oResp=eval("("+response+")"),bApply,htmlP,oSW,htmlMsg,inp,inp2,options;if(oResp.StopWatch.Status=="0"){bApply=!1;htmlP=document.createElement("p");htmlP.setAttribute("style","padding:10px");htmlMsg=document.createTextNode("Would you like to apply the following to your timesheet: ");htmlP.appendChild(htmlMsg);htmlP.appendChild(document.createElement("br"));htmlP.appendChild(document.createElement("br"));StopWatchResponse=oResp.StopWatch;for(oSW in oResp.StopWatch)if(oSW!="Status"){var oSWV=oResp.StopWatch[oSW],oDate=new Date(oSWV.Date),oMinutes=oSWV.Minutes,oCol=grid.Cols["P"+oSWV.DateTicks];oCol&&(bApply=!0,htmlMsg=document.createTextNode(oDate.format("MMM dd")+": "+GetTimeDisplay(parseFloat(oMinutes)*6e4)),htmlP.appendChild(htmlMsg),htmlP.appendChild(document.createElement("br")))}bApply?(curStoppingGrid=grid,curStoppingRow=row,inp=document.createElement("input"),inp.setAttribute("type","button"),inp.setAttribute("value","Yes"),inp.setAttribute("onclick","SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.OK, 0);"),htmlP.appendChild(document.createElement("br")),htmlP.appendChild(document.createElement("br")),htmlP.appendChild(inp),inp2=document.createElement("input"),inp2.setAttribute("type","button"),inp2.setAttribute("value","No"),inp2.setAttribute("onclick","SP.UI.ModalDialog.commonModalDialogClose(SP.UI.DialogResult.Cancel, 0);"),htmlP.appendChild(inp2),options={title:"Confirm Hours",width:300,html:htmlP,dialogReturnValueCallback:StopStopWatchClose},SP.UI.ModalDialog.showModalDialog(options)):alert("There were no dates to apply to this period");grid.SetAttribute(row,"StopWatch","Icon","/_layouts/epmlive/images/tstimeroff.png",!0,!1);StopWatchRow=null;grid.SetValue(row,"StopWatch","",1,0)}else alert(oResp.StopWatch.Text)})}function StartStopWatch(grid,row){var newgridid=grid.id.substr(2),newobj=eval("TSObject"+newgridid),url;IsLocked(grid)?alert("You cannot start a stop watch on a submitted timesheet"):newobj.IsCurPeriod?EPMLiveCore.WorkEngineAPI.ExecuteJSON("timesheet_StartStopWatch",'<StopWatch ID="'+row.UID+'" UserId="'+newobj.UserId+'"/>',function(response){var oResp=eval("("+response+")");oResp.StopWatch.Status=="0"?(grid.SetValue(row,"StopWatch",oResp.StopWatch.Text,1,0),grid.SetAttribute(row,"StopWatch","Icon","/_layouts/epmlive/images/tstimeron.png",!0,!1),StopWatchRow=row,StopWatchGrid=grid,RefreshStopWatch()):alert(oResp.StopWatch.Text)}):newobj.CurPeriodId==0?alert("You can only start stopwatches within the period that the current date resides and there seems to be no period setup for today's date."):confirm("You can only start stopwatches within the period that the current date resides. Would you like to switch to period: "+newobj.CurPeriodName+"?")&&(url=newobj.TSURL,url+=url.indexOf("?")>0?"&":"?",location.href=url+"NewPeriod="+newobj.CurPeriodId)}function ShowApprovalNotes(n,t,i){var r=Grids[n],u=r.GetRowById(t),f=$("#"+i.id),e;curPop=!0;e=f.offset().top-87;$("body").append("<div id='divanotes"+t.replace(/-/g,"")+"' style='width:150px;height:100px;position:absolute;left:"+f.offset().left+"px;top:"+e+'px;border:1px solid #DDD;background-color:#FFF\' onMouseDown="stopProp(event);" ><textarea id="anotestxt'+t.replace(/-/g,"")+'" style=\'width:140px;height:60px;border:none;resize: none;outline:none\' onkeyup="stopProp(event);" onclick="stopProp(event);" onkeypress="stopProp(event);">'+r.GetValue(u,"ApprovalNotes")+'<\/textarea><input type="button" style="float:right" value="Ok" onclick="CloseApprovalNotes(\''+r.id+"','"+u.id+"');\"><\/div>")}function CloseApprovalNotes(n,t){var i=Grids[n],r=i.GetRowById(t),u=$("#anotestxt"+t.replace(/-/g,""));i.SetValue(r,"ApprovalNotes",u.get(0).value,1);$("#divanotes"+t.replace(/-/g,"")).remove();curPop=!1}function MYTSOnGetHtmlValue(n,t,i,r){var u;if(n.id.substr(0,2)=="TS")if(t.Def.Name=="Resource"){if(i=="ApprovalNotes")return u="DDD",n.GetValue(t,i)!=""&&(u="888"),t.Approved=="1"||t.Approved=="2"||t.Submitted=="1"?"<a onclick=\"ShowApprovalNotes('"+n.id+"','"+t.id+'\', this)" id="ANote'+t.id+"\" style=\"text-decoration:none;\"><span class='icon-file-3' style='color:#"+u+";text-decoration:none;font-size:15px'><\/a>":"";if(i=="TMApproval")return t.Approved=="1"?'<span class="icon-checkmark-circle-2" style="color:#5BB75B">':t.Approved=="2"?'<span class="icon-cancel-circle-2" style="color:#D9534F">':t.Submitted=="1"?'<span class="icon-redo" style="color:#888">':""}else if(t.Def.Name=="R")if(i=="StopWatch"){if(StopWatchRow&&t.UID==StopWatchRow.UID){var e=new Date(r),o=new Date((new Date).getTime()-curServerDate),f=o.getTime()-e.getTime();return f<0?"0m":GetTimeDisplay(f)}}else{if(TSCols[i]||i=="TSTotals")return r=="0"||r==""?"":getFormattedNumber(r.toLocaleString(),n);if(i=="Progress"&&t.Def.Name=="R")try{return(parseFloat(r)*100).toFixed(0)+"%"}catch(s){return"0%"}else if(i=="Title")return n.GetValue(t,"HasComments")=="1"?r=r+"&nbsp;<a href=\"javascript:GridComments('"+n.id+"','"+t.id+'\');return false;"><img src="/_layouts/15/epmlive/images/mywork/comment-small.png" border="0"><\/a>':n.GetValue(t,"HasComments")=="2"&&(r=r+"&nbsp;<a href=\"javascript:GridComments('"+n.id+"','"+t.id+'\');return false;"><img src="/_layouts/15/epmlive/images/mywork/commentsnew-small.png" border="0"><\/a>'),r}else if(t.id=="Header")return i=="Panel"?null:r;return r==""?"":null}function GridComments(n,t){var u=Grids[n],r=u.GetRowById(t),f,i;CurrentGrid=u;CurrentRow=r;n=GetGridId(u);f=window.epmLiveNavigation.currentWebUrl+"/_layouts/epmlive/gridaction.aspx?action=comments&webid="+r.WebID+"&listid="+r.ListID+"&ID="+r.ItemID+"&Source="+escape(location.href);i=window.SP.UI.$create_DialogOptions();i.url=f;i.width=600;i.allowMaximize=!1;i.showClose=!0;window.SP.UI.ModalDialog.showModalDialog(i)}function getFormattedNumber(Amount,grid){var newgridid=grid.id.substr(2),newobj=eval("TSObject"+newgridid),DecimalSeparator=Number("1.2").toLocaleString().substr(1,1),AmountWithCommas=Amount.toLocaleString(),arParts=String(AmountWithCommas).split(DecimalSeparator),intPart=arParts[0],decPart=arParts.length>1?arParts[1]:"";return decPart=(decPart+"00").substr(0,2),parseInt(decPart)==0&&(decPart="",DecimalSeparator=""),intPart+newobj.DecimalSeparator+decPart}function GetTimeDisplay(n){var r=6e4,u=r*60,e=u*24,f=Math.floor(n/e),t,i,o;return n=n-f*e,t=Math.floor(n/u),n=n-t*u,i=Math.floor(n/r),n=n-i*r,o=Math.floor(n/1e3),f>0?f+"d "+t+"h "+i+"m":t>0?t+"h "+i+"m":i+"m"}function RefreshStopWatch(){StopWatchRow&&StopWatchGrid&&(StopWatchGrid.RefreshCell(StopWatchRow,"StopWatch"),setTimeout("RefreshStopWatch()",3e4))}function GetDecimalFromTime(n){var i=n.split(":"),r=StringToNumber(i[0]),t;return i.length>1&&(t=StringToNumber(i[1]),t=t/60,r+=t),parseFloat(r.toFixed(2))}function CloseTypes(n){curGrid.EndEdit(!1);curGrid.SetAttribute(curRow,curCol,"HtmlPrefix","",!0,!1);curPop=!1;$("#TypeDivOuter").remove();stopProp(n)}function SaveTypes(n){var t,r,u,f,i;curGrid.EndEdit(!1);t="";r=0;for(u in TSTypeObject)f=document.getElementById(u+"TypeValue").value,f!=""&&(i=GetDecimalFromTime(f),i!="NaN"&&i!=0&&(t+=","+u+": "+i,r+=i));TSNotes&&(t+=',Notes: "'+escape(document.getElementById("txtTNotes").value.replace(/\r\n/g,"<br>"))+'"');t.length>0&&(t=t.substr(1));t="{"+t+"}";curGrid.SetAttribute(curRow,curCol,"HtmlPrefix","",!0,!1);curGrid.SetValue(curRow,curCol,r,1,0);curGrid.GetValue(curRow,"TS"+curCol)!=t&&(TimesheetHoursEdited=!0);curGrid.SetValue(curRow,"TS"+curCol,t,0,0);curPop=!1;$("#TypeDivOuter").remove();stopProp(n)}function SaveNotes(n){var t,i;NotesOut=!1;t=document.getElementById("txtNotes").value;TSColType==1&&curGrid.SetValue(curRow,"TS"+curCol,t);document.getElementById("NotesDiv").style.display="none";i=document.getElementById("notesimg");i.src=t==""?"/_layouts/epmlive/images/tsnonotes.png":"/_layouts/epmlive/images/tsnotes.png";stopProp(n)}function stopProp(n){n.stopPropagation?n.stopPropagation():window.event&&(window.event.cancelBubble=!0)}function BeforeSave(n){if(typeof TimesheetBeforeSave=="function"){try{var t=TimesheetBeforeSave(n);return t.CanSave?!0:(alert(t.Message),!1)}catch(i){alert("Error Checking Save: "+i)}return!1}return!0}function AfterSave(n){if(typeof TimesheetAfterSave=="function")try{TimesheetAfterSave(n)}catch(t){alert("Error After Save: "+t)}}function BeforeSubmit(n){if(typeof TimesheetBeforeSubmit=="function"){try{var t=TimesheetBeforeSubmit(n);return t.CanSubmit?!0:(alert(t.Message),!1)}catch(i){alert("Error Checking Submit: "+i)}return!1}return!0}function IsLocked(grid){var newgridid=grid.id.substr(2),newobj=eval("TSObject"+newgridid);return newobj.Locked||bTSApproving?!0:newobj.Status!="Unsubmitted"?!0:!1}function AfterSubmit(n){if(typeof TimesheetAfterSubmit=="function")try{TimesheetAfterSubmit(n)}catch(t){alert("Error After Submit: "+t)}}function BeforeUnSubmit(n){if(typeof TimesheetBeforeUnSubmit=="function"){try{var t=TimesheetBeforeUnSubmit(n);return t.CanUnSubmit?!0:(alert(t.Message),!1)}catch(i){alert("Error Checking UnSubmit: "+i)}return!1}return!0}function AfterUnSubmit(n){if(typeof TimesheetAfterUnSubmit=="function")try{TimesheetAfterUnSubmit(n)}catch(t){alert("Error After UnSubmit: "+t)}}function fireEvent(n,t){var i;return document.createEventObject?(i=document.createEventObject(),n.fireEvent("on"+t,i)):(i=document.createEvent("HTMLEvents"),i.initEvent(t,!0,!0),!n.dispatchEvent(i))}function leavePage(){var n="";return TimesheetHoursEdited&&(n="You have unsaved changes."),n!=""?n:void 0}function ShowApprovalNotification(){EPMLiveCore.WorkEngineAPI.set_path(siteUrl+"/_vti_bin/WorkEngine.asmx");EPMLiveCore.WorkEngineAPI.ExecuteJSON("timesheet_ShowApprovalNotification","<ApprovalNotification PeriodId='"+periodId+"' />",function(response){var oResp=eval("("+response+")");oResp.ApprovalNotification.Status=="0"&&oResp.ApprovalNotification.Text!="0"?updateStatusBox?SP.UI.Status.updateStatus(updateStatusBox,"You have "+oResp.ApprovalNotification.Text+" timesheet(s) pending for approval <a href='#' onclick='Javascript:DoTmAprrovals();'>[Timesheet Manager]<\/a>"):(updateStatusBox=SP.UI.Status.addStatus("Notification:","You have "+oResp.ApprovalNotification.Text+" timesheet(s) pending for approval <a href='#' onclick='Javascript:DoTmAprrovals();'>[Timesheet Manager]<\/a>",!0),SP.UI.Status.setStatusPriColor(updateStatusBox,"blue")):oResp.ApprovalNotification.Text!="0"&&SP.UI.Status.removeStatus(updateStatusBox)})}function DoTmAprrovals(){var n=siteColUrl+"/_layouts/15/epmlive/mytimesheet.aspx?Approvals=true";location.href=n}function showComments(n){var i=Grids[n],t=i.ARow,r=siteUrl+"/_layouts/epmlive/gridaction.aspx?action=comments&webid="+t.WebID+"&listid="+t.ListID+"&ID="+t.ItemID,u={title:"Comments",allowMaximize:!0,showClose:!0,url:r};SP.UI.ModalDialog.showModalDialog(u)}function previousPeriodCommand(n,t,i){if(t!="0"){var r=n;r+=r.indexOf("?")>0?"&NewPeriod="+t:"?NewPeriod="+t;i!=""&&(r+="&Delegate="+i);location.href=r}}function nextPeriodCommand(n,t,i){if(t!="0"){var r=n;r+=r.indexOf("?")>0?"&NewPeriod="+t:"?NewPeriod="+t;i!=""&&(r+="&Delegate="+i);location.href=r}}function changePeriodCommand(n,t,i){var r=n,u=t.options[t.selectedIndex].value;r+=r.indexOf("?")>0?"&NewPeriod="+u:"?NewPeriod="+u;i!=""&&(r+="&Delegate="+i);location.href=r}function GetPageHeight(){var n;return self.innerHeight?n=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?n=document.documentElement.clientHeight:document.body&&(n=document.body.clientHeight),n}function GetItemTop(n){for(var t=n.offsetTop;n.offsetParent;)if(t=t+n.offsetParent.offsetTop,n==document.getElementsByTagName("body")[0])break;else n=n.offsetParent;return t}var curRow,curCol,TSColType,TSNotes,TSTypeObject,TSCols,curGrid,curPop=!1,StopWatchRow=null,StopWatchGrid=null,siteId,siteUrl,siteColUrl,periodId,sApplyDates="",curStoppingRow,curStoppingGrid,StopWatchResponse,bStopWatchStartWaiting=!1,cView,TSStatusMessage=null,TSApprovalMessage=null,bTSSaving=!1,bTSApproving=!1,iApproveInterval,curServerDate,spnMsg=null,bSaveAndSubmit=!1,updateStatusBox,NotesOut=!1,TimesheetHoursEdited=!1,TimesheetItemEdited=!1;Grids.OnRenderStart=function(grid){var newgridid,newobj,R,oRow;if(grid.id.substr(0,2)=="TS"){newgridid=grid.id.substr(2);newobj=eval("TSObject"+newgridid);newobj&&(grid.TSObject=newobj);for(R in grid.Rows)oRow=grid.Rows[R],oRow.Kind=="Data"&&grid.GetValue(oRow,"StopWatch")!=""&&(StopWatchRow=oRow,StopWatchGrid=grid);EPMLiveCore.WorkEngineAPI.set_path(siteUrl+"/_vti_bin/WorkEngine.asmx")}};Grids.OnStartEdit=function(){if(NotesOut){NotesOut=!1;var n=document.getElementById("NotesDiv");n.style.display="none"}};Grids.OnScroll=function(n){curRow&&curRow.Kind=="Data"&&curRow.id!="-1"&&curCol&&TSCols[curCol]&&(n.SetAttribute(curRow,curCol,"HtmlPrefix","",!0,!1),curPop=!1)};Grids.OnKeyDown=function(n,t){if(curPop||t==46)return!0;curGrid=n;setTimeout("esGrid()",10)};Grids.OnEnterEdit=function(){curPop&&setTimeout("curGrid.StartEdit()",100)};Grids.OnKeyPress=function(){};Grids.OnAfterSave=function(n){n.id.substr(0,2)=="TS"&&((n.IO.Result=="0"||n.IO.Result=="2")&&(bTSSaving=!0,RefreshCommandUI(),CheckSaveStatus(n.id)),HideMessage(n.id))};Grids.OnClickOutside=function(n){if(NotesOut){NotesOut=!1;curPop=!1;var t=document.getElementById("NotesDiv");t.style.display="none"}try{$("#TypeDivOuter").remove()}catch(i){}n.EditRow&&StopEditGridRow(n,n.GetRowById("Header"))};$(window).resize(function(){SetGridSize()});Grids.OnIconClick=function(n,t,i,r){n.id.substr(0,2)=="TS"&&r<16&&i=="StopWatch"&&(StopWatchRow?StopWatchRow.UID==t.UID?confirm("Would you like to stop that stop watch now?")&&StopStopWatch(n,t):confirm("There is already a stop watch running. Would you like to stop that stopwatch and start this one?")?(curGrid=n,curRow=t,StopStopWatch(StopWatchGrid,StopWatchRow),bStopWatchStartWaiting=!0):bStopWatchStartWaiting:StartStopWatch(n,t))};Grids.OnValueChanged=function(n,t,i,r){var f,u;if(n.id.substr(0,2)=="TS"&&t&&t.Kind=="Data"&&t.id!="-1"&&i&&TSCols[i]&&(r.toString()==""&&(r="0"),f=GetDecimalFromTime(r),u=n.GetValue(t,i),f.toString()=="NaN"?(alert("That is not a valid entry."),r=u):r=f,TSDCols[i])){var e=TSDCols[i].split("|"),o=parseFloat(e[0]),s=parseFloat(e[1]);r>s&&(alert("You may only enter a maximum time of "+s+" hours"),r=u);r<o&&(alert("You must enter atleast time of "+o+" hours"),r=u)}return r};
/*
//# sourceMappingURL=MyTimesheet.min.js.map
*/